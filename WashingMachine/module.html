<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <script src="https://kit.fontawesome.com/7da29d74de.js" crossorigin="anonymous"></script>

    <style>
        /* Grundlegende Stildefinitionen, keine Änderungen hier */

        :root {
            --background-image: #000000;
            --balkenverlauffarbe1: #28CDAB; /* Standardfarbe setzen, um sicherzustellen, dass die Farbe existiert */
            --balkenverlauffarbe2: #208A74; /* Ergänzende Farbe setzen */
            --programmfortschrittvalue: 0%; /* Standardwert setzen */
            --statusschriftgroesse: 1em; /* Standard Schriftgröße */
            --programmschriftgroesse: 1em;
            --infoschriftgroesse: 1em;
            --balkenschriftgroesse: 1em;
        }

        .hidden {
            display: none;
        }

        .main_container {
            width: 100%;
            display: flex;
            flex-wrap: nowrap;
            position: relative;
            font-size: 1em;
        }

        .div1 {
            width: var(--bildbreite);
        }

        .div1 img {
            width: 100%;
        }

        .div2 {
            width: 80%;
            padding: 0px 5px 5px 2.5%;
            margin: 0px 0px 0px 2.5%;
            border-radius: 0px;
            border-left: 1px dotted #28cdab;
        }

        .balkendiagramm {
            width: 100%;
            display: flex;
            position: relative;
            margin-bottom: 3%;
        }

        @keyframes gradient_forschritt {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: -200% 0;
            }
        }

        .balken_links_fortschritt {
            width: var(--programmfortschrittvalue); /* Stellen Sie sicher, dass diese Variable korrekt gesetzt wird */
            background: repeating-linear-gradient(to right, var(--balkenverlauffarbe1) 0%, var(--balkenverlauffarbe2) 50%, var(--balkenverlauffarbe1) 100%);
            background-size: 200% auto;
            animation: gradient_forschritt 10s infinite;
            height: 25px;
            border-radius: 8px 0px 0px 8px;
            transition: width 2s;
        }


        .balken_links_text {
            position: absolute;
            top: 50%;
            left: 2%;
            transform: translate(-0%, -50%);
            color: white;
            z-index: 2;
            padding: 3px;
        }


        .balkentext {
            font-size: var(--balkenschriftgroesse);
        }


        .balken_links_text_finish {
            position: absolute;
            top: 50%;
            right: 2%;
            transform: translate(-0%, -50%);
            color: white;
            z-index: 3;
            padding: 3px;
        }

        .balken_rechts {
            width: 100%;
            border-radius: 8px;
            background: linear-gradient(to right, rgba(135, 135, 135, 0.6) 0%, rgba(135, 135, 135, 0.2) 100%);
            transition: width 2s;
            transition-timing-function: ease;
            overflow: hidden;
        }



        .status {
            font-size: var(--statusschriftgroesse);
            display: inline-block;
            margin: 0;
        }


        .status_0 {
            color: #000000;
        }

        .status_1 {
            color: #000000;
        }

        .status_2 {
            color: #000000;
        }

        .status_3 {
            color: #fc9003;
        }

        .status_4 {
            color: #03a1fc;
        }

        .status_5 {
            color: #fc9003;
        }

        .status_6 {
            color: #000000;
        }

        .status_7 {
            color: #000000;
        }

        .status_8 {
            color: #000000;
        }

        .status_9 {
            color: #000000;
        }

        @keyframes blink {
            0% {
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        .container_daten {
            display: flex;
            flex-wrap: nowrap;
            width: 100%;
        }

        .daten_links {
            margin-right: 20px;
            border: 0px solid #000;
        }

        .daten_rechts {
            border: 0px solid #000;
        }


        .info {
            font-size: var(--infoschriftgroesse);
            margin-top: 10px;
            padding: 0px 0px 0px 0px;
        }

        .programm {
            font-size: var(--programmschriftgroesse);
            margin: 0px 0px 5px 0px;
            padding: 0px 0px 0px 0px;
        }
    </style>


    <script>
        function handleMessage(data) {
            //console.log('Rohdaten empfangen:', data);

            const decodedData = JSON.parse(data);

            console.log('Decodierte Daten:', decodedData);

            for (const parameter in decodedData) {
                //console.log('Aktueller Parameter:', parameter, 'Wert:', decodedData[parameter]);

                const element = document.getElementById(parameter.toLowerCase());
                const parameter2 = String(parameter).toLowerCase();
                //console.log('Aktueller Parameter:', parameter, 'Wert:', decodedData[parameter]);
                var root = document.documentElement;
                // Abhängig vom Parameter werden allerdings verschiedene Werte angepasst
                switch (parameter2) {
                    
                    case 'status':
                        element.textContent = decodedData[parameter];
                        break;
                    case 'statusvalue':
                        let index = decodedData[parameter];
                            if (!statusImages[index]) {
                                index = 0;
                            }
                            if (statusImages[index] === 'wm_an') {
                                document.getElementById('image').src = window.assets.img_wm_an;
                            }
                            else if (statusImages[index] === 'wm_aus') {
                                document.getElementById('image').src = window.assets.img_wm_aus;
                            }
                            else {
                                document.getElementById('image').src = window.assets.img_wm_aus;
                            }
                            break;
                        case 'programm':
                        //element.className = 'infolinksasso';
                        element.textContent = decodedData[parameter];
                        break;    
                    case 'laufzeit':
                        //element.className = 'infolinksasso';
                        element.textContent = decodedData[parameter];
                        break;    
                    case 'programmfortschrittvalue':
                        root.style.setProperty('--programmfortschrittvalue', decodedData[parameter] + '%');
                        break;
                    case 'programmfortschritt':
                        element.textContent = decodedData[parameter];
                        break;
                    case 'restlaufzeitvalue':
                        let restmin = Math.round(decodedData[parameter] / 60);
                        restlaufzeit.textContent = restmin;
                        break;
                    case 'verbrauch':
                        element.textContent = decodedData[parameter];
                        break;
                    case 'verbrauchtag':
                        element.textContent = decodedData[parameter];
                        break;
                    case 'balkenverlauffarbe1':
                        root.style.setProperty('--balkenverlauffarbe1', decodedData[parameter]);
                        break;
                    case 'balkenverlauffarbe1':
                        root.style.setProperty('--balkenverlauffarbe1', decodedData[parameter]);
                        break;
                    case 'statusschriftgroesse':
                        root.style.setProperty('--statusschriftgroesse', decodedData[parameter] + 'em');
                        break;
                    case 'programmschriftgroesse':
                        root.style.setProperty('--programmschriftgroesse', decodedData[parameter] + 'em');
                        break;
                    case 'infoschriftgroesse':
                        root.style.setProperty('--infoschriftgroesse', decodedData[parameter] + 'em');
                        break;
                    case 'balkenschriftgroesse':
                        root.style.setProperty('--balkenschriftgroesse', decodedData[parameter] + 'em');
                        break;
                    case 'bildbreite':
                        root.style.setProperty('--bildbreite', decodedData[parameter] + '%');
                        break;
                    default:
                        //console.log('Setze innerHTML für', parameter);
                        // Setze innerHTML nur, wenn das Element gefunden wurde
                        //element.innerHTML = decodedData[parameter];<i id="temp_icon" class="fa-solid fa-house-chimney-user icon"></i>
                        break;
                }

            }
        }
    </script>


</head>

<body>
    <div class="main_container">
        <div id="div1" class="div1"><img id="image"></div>
        <div class="div2">
            <b><p class="status">Status:&nbsp;</p></b><span class="status" id="status"></span><br>
            <div class="programm"><span class="programm"><b>Programm:&nbsp;</b><span id="programm"></span></span></div>
            <div class="balkendiagramm">
                <div class="balken_rechts">
                    <div class="balken_links_fortschritt">
                        <span class="balken_links_text"><i class="fa-regular fa-circle-right fa-sm" style="color: #ffffff;"></i>&nbsp;&nbsp;<span class="balkentext" id="programmfortschritt">0</span></span>
                        <span class="balken_links_text_finish"><i class="fa-regular fa-clock fa-sm" style="color: #ffffff;"></i>&nbsp;&nbsp;<span class="balkentext" id="restlaufzeit">0</span>&nbsp;m</span>
                    </div>
                </div>
            </div>
            <div class="info"> <i class="fa-solid fa-bolt fa-sm" style="color: #28cdab;"></i>&nbsp;&nbsp;<span id="verbrauch"></span>&nbsp;&nbsp;&nbsp;Tag: <span id="verbrauchtag"></span></div>
        </div>
    </div>
</body>

</html>